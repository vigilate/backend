from django.shortcuts import render
from django.http import HttpResponse
from vulnerability_manager import Cpe
import cpe_updater

@list_route(methods=['get'])
def update_cpe(request):
    cpes = cpe_updater.do_update()
    for cpe in cpes:
        #cpe already exist
        if len(Cpe.objects.filter(cpe = cpe)):
            continue
        parts = cpe.split(':')
        if parts[1] = '/h':
            continue
        new_cpe = Cpe(cpe=cpe, vendor=parts[2], product=parts[3], version = parts[4])
        new_cpe.save()
