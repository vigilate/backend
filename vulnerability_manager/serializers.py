from rest_framework import serializers
from vulnerability_manager import models


class ReferenceSerializer(serializers.ModelSerializer):
    """Serialisation of Reference
    """

    class Meta:
        model = models.Reference
        fields = ("source", "value", "href")
    
class CveSerializer(serializers.ModelSerializer):
    """Serialisation of Cve
    """

    reference_set = ReferenceSerializer(read_only=True, many=True)
    
    class Meta:
        model = models.Cve
        fields = ("cveid", "published_date", "modified_date", "cvss_score", "cvss", "cwe", "cpe", "summary", "reference_set")


