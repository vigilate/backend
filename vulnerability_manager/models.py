from django.db import models

class Cve(models.Model):
    cveid = models.CharField(max_length=20, primary_key=True)
    published_date = models.DateField()
    modified_date = models.DateField()
    cvss_score = models.FloatField(null=True, default=None)
    cvss = models.CharField(max_length=200, null=True, default="")
    cwe = models.ForeignKey('Cwe', on_delete=models.SET_DEFAULT, null=True, default=None)
    cpe = models.ManyToManyField('Cpe')
    summary = models.TextField(default="", null=True)

class Cpe(models.Model):
    cpe = models.CharField(max_length=200, primary_key=True)
    product = models.CharField(max_length=100)
    version = models.CharField(max_length=100)

class Cwe(models.Model):
    cweid = models.CharField(max_length=20, primary_key=True)
    title = models.TextField()
    summary = models.TextField()
    description = models.TextField()

class Reference(models.Model):
    source = models.CharField(max_length=20)
    value = models.TextField(default="")
    type = models.TextField(default="")
    href = models.TextField(default="")
    cve = models.ForeignKey('Cve', on_delete=models.CASCADE)

    
